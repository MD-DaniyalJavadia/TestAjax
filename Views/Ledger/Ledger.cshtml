@model TestAjax.Models.Contact

@{
    ViewData["Title"] = Model.Name;

    var balance = (decimal)ViewData["Balance"];
    var transactions = ViewData["Transactions"] as List<TestAjax.Models.Transaction>
        ?? new List<TestAjax.Models.Transaction>();

    string statusText = balance > 0 ? "I will receive"
                      : balance < 0 ? "I will give"
                      : "Balance settled";

    string colorClass = balance > 0 ? "text-success"
                      : balance < 0 ? "text-danger fw-bold"
                      : "text-muted";

    string displayAmount = Math.Abs(balance).ToString("N0");
}

<div class="page-inner">
    <div class="d-flex align-items-center mb-3">
        <a asp-controller="Home" asp-action="Index" class="me-3 text-dark">
            <i class="fas fa-arrow-left fa-lg"></i>
        </a>
        <h4 class="mb-0 fw-bold">@Model.Name</h4>

        <div class="ms-auto d-flex gap-2">
            <button class="btn btn-outline-secondary btn-sm">
                <i class="far fa-calendar-alt me-1"></i> Select date
            </button>
            <button class="btn btn-outline-primary btn-sm">
                <i class="fas fa-download me-1"></i> DOWNLOAD PDF
            </button>
        </div>
    </div>

    <!-- Balance Card (Udhaar.pk style) -->
    <div class="card shadow-sm border-0 mb-4">
        <div class="card-body text-center py-5">
            <h6 class="text-muted mb-2">@statusText</h6>
            <h1 class="display-5 fw-bold @colorClass">Rs. @displayAmount</h1>
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="d-flex justify-content-center gap-3 mb-4">
        <a asp-action="Add" asp-route-id="@Model.Id" asp-route-type="Received"
           class="btn btn-success btn-lg px-5">
            ↓ I TOOK
        </a>
        <a asp-action="Add" asp-route-id="@Model.Id" asp-route-type="Given"
           class="btn btn-danger btn-lg px-5">
            ↑ I GAVE
        </a>
    </div>

    @if (transactions.Any())
    {
        <div class="card shadow-sm border-0">
            <div class="table-responsive">
                <table class="table table-hover mb-0">
                    <thead class="table-light">
                        <tr>
                            <th>Date & Time</th>
                            <th>Details</th>
                            <th class="text-end">Received</th>
                            <th class="text-end">Given</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var t in transactions)
                        {
                            <tr>
                                <td>
                                    @t.TransactionDate
                                    <small class="d-block text-muted">
                                        @t.TransactionDate
                                    </small>
                                </td>
                                <td>
                                    @(string.IsNullOrWhiteSpace(t.Details) ? "—" : t.Details)
                                </td>
                                <td class="text-end text-success fw-medium">
                                    @(t.Type == "Received" ? t.Amount.ToString("N0") : "—")
                                </td>
                                <td class="text-end text-danger fw-medium">
                                    @(t.Type == "Given" ? t.Amount.ToString("N0") : "—")
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    }
    else
    {
        <div class="text-center py-5 text-muted">
            <i class="far fa-file-alt fa-3x mb-3 d-block"></i>
            <p>No transactions yet</p>
        </div>
    }
</div>